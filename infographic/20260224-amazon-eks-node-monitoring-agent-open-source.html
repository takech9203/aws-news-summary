<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Amazon EKS - Node Monitoring Agent のオープンソース化</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/styles/atom-one-dark.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&display=swap');

    :root {
      --aws-squid-ink: #232F3E;
      --aws-dark-squid: #1A242F;
      --aws-orange: #FF9900;
      --aws-smile-orange: #FFAD33;
      --aws-white: #FFFFFF;
      --aws-light-gray: #D5DBDB;
      --aws-teal: #00A1C9;
      --aws-purple: #8C4FFF;
      --aws-green: #1D8102;
      --aws-red: #D13212;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background-color: var(--aws-squid-ink);
      font-family: 'Noto Sans JP', 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
      color: var(--aws-light-gray);
      font-size: 16px;
      line-height: 1.6;
      padding: 20px;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
      width: 100%;
    }

    /* ===== Header ===== */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 32px;
      flex-wrap: wrap;
      gap: 16px;
    }

    .header-left { flex: 1; }

    .service-badge {
      display: inline-block;
      background: var(--aws-orange);
      color: var(--aws-squid-ink);
      font-size: 13px;
      font-weight: 700;
      padding: 4px 14px;
      border-radius: 20px;
      margin-bottom: 12px;
      letter-spacing: 0.5px;
    }

    h1 {
      font-size: 36px;
      font-weight: 700;
      color: var(--aws-white);
      line-height: 1.3;
      margin-bottom: 8px;
    }

    .subtitle {
      font-size: 16px;
      color: var(--aws-light-gray);
    }

    .header-right {
      text-align: right;
      font-size: 14px;
      color: var(--aws-light-gray);
      flex-shrink: 0;
    }

    .date-label {
      color: var(--aws-orange);
      font-weight: 600;
    }

    /* ===== Sections ===== */
    h2 {
      font-size: 24px;
      font-weight: 600;
      color: var(--aws-orange);
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section {
      background: var(--aws-dark-squid);
      border-radius: 8px;
      padding: 24px;
      margin-bottom: 24px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .highlight {
      background-color: rgba(255, 153, 0, 0.2);
      padding: 2px 6px;
      border-radius: 4px;
      font-weight: 600;
      color: var(--aws-orange);
    }

    /* ===== Overview Text ===== */
    .overview-text {
      font-size: 16px;
      color: var(--aws-light-gray);
      line-height: 1.8;
      margin-bottom: 20px;
    }

    /* ===== Before/After ===== */
    .before-after {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      margin-top: 16px;
    }

    @media (max-width: 640px) {
      .before-after { grid-template-columns: 1fr; }
    }

    .before-card, .after-card {
      border-radius: 8px;
      padding: 20px;
    }

    .before-card {
      background: rgba(209, 50, 18, 0.1);
      border: 1px solid rgba(209, 50, 18, 0.3);
    }

    .after-card {
      background: rgba(29, 129, 2, 0.1);
      border: 1px solid rgba(29, 129, 2, 0.3);
    }

    .ba-label {
      font-size: 13px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .before-card .ba-label { color: var(--aws-red); }
    .after-card .ba-label { color: var(--aws-green); }

    .ba-list {
      list-style: none;
      padding: 0;
    }

    .ba-list li {
      padding: 6px 0;
      font-size: 14px;
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .ba-list li::before { flex-shrink: 0; }
    .before-card .ba-list li::before { content: "\2717"; color: var(--aws-red); font-weight: bold; }
    .after-card .ba-list li::before { content: "\2713"; color: var(--aws-green); font-weight: bold; }

    /* ===== Stats Cards ===== */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      margin-bottom: 24px;
    }

    @media (max-width: 640px) {
      .stats-grid { grid-template-columns: 1fr 1fr; }
    }

    .stat-card {
      background: linear-gradient(135deg, rgba(255, 153, 0, 0.15), rgba(140, 79, 255, 0.1));
      border: 1px solid rgba(255, 153, 0, 0.3);
      border-radius: 8px;
      padding: 20px;
      text-align: center;
    }

    .stat-number {
      font-size: 32px;
      font-weight: 700;
      color: var(--aws-orange);
      line-height: 1.2;
    }

    .stat-label {
      font-size: 13px;
      color: var(--aws-light-gray);
      margin-top: 4px;
    }

    /* ===== Feature Cards ===== */
    .feature-card {
      background: var(--aws-dark-squid);
      border-radius: 8px;
      padding: 24px;
      margin-bottom: 16px;
      border-left: 4px solid var(--aws-orange);
      border-top: 1px solid rgba(255, 255, 255, 0.08);
      border-right: 1px solid rgba(255, 255, 255, 0.08);
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    }

    .feature-card.teal { border-left-color: var(--aws-teal); }
    .feature-card.purple { border-left-color: var(--aws-purple); }
    .feature-card.green { border-left-color: var(--aws-green); }

    .feature-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--aws-white);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .feature-desc {
      font-size: 14px;
      color: var(--aws-light-gray);
      line-height: 1.7;
    }

    .feature-desc ul {
      list-style: none;
      padding: 0;
      margin-top: 8px;
    }

    .feature-desc ul li {
      padding: 4px 0;
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .feature-desc ul li::before {
      content: "\2192";
      color: var(--aws-orange);
      font-weight: bold;
      flex-shrink: 0;
    }

    /* ===== Table ===== */
    .table-wrapper {
      overflow-x: auto;
      margin: 16px 0;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    th {
      background: rgba(255, 153, 0, 0.15);
      color: var(--aws-orange);
      font-weight: 600;
      padding: 12px 16px;
      text-align: left;
      border-bottom: 2px solid rgba(255, 153, 0, 0.3);
      white-space: nowrap;
    }

    td {
      padding: 10px 16px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.06);
      color: var(--aws-light-gray);
    }

    tr:hover td {
      background: rgba(255, 255, 255, 0.03);
    }

    /* ===== Use Case Cards ===== */
    .usecase-card {
      background: linear-gradient(135deg, rgba(255, 153, 0, 0.08), rgba(255, 153, 0, 0.03));
      border: 1px solid rgba(255, 153, 0, 0.2);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .usecase-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--aws-white);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .usecase-scenario {
      font-size: 14px;
      color: var(--aws-light-gray);
      margin-bottom: 8px;
    }

    .usecase-effect {
      font-size: 14px;
      color: var(--aws-smile-orange);
      font-weight: 500;
    }

    /* ===== Merits/Demerits ===== */
    .merit-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }

    @media (max-width: 640px) {
      .merit-grid { grid-template-columns: 1fr; }
    }

    .merit-box {
      border-radius: 8px;
      padding: 20px;
    }

    .merit-box.business {
      background: rgba(255, 153, 0, 0.08);
      border: 1px solid rgba(255, 153, 0, 0.2);
    }

    .merit-box.technical {
      background: rgba(0, 161, 201, 0.08);
      border: 1px solid rgba(0, 161, 201, 0.2);
    }

    .merit-box h3 {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .merit-box.business h3 { color: var(--aws-orange); }
    .merit-box.technical h3 { color: var(--aws-teal); }

    .merit-list {
      list-style: none;
      padding: 0;
    }

    .merit-list li {
      padding: 6px 0;
      font-size: 14px;
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .merit-list li strong {
      color: var(--aws-white);
    }

    /* ===== Caution / Limitations ===== */
    .caution-card {
      background: rgba(209, 50, 18, 0.06);
      border: 1px solid rgba(209, 50, 18, 0.2);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .caution-card h3 {
      font-size: 16px;
      font-weight: 600;
      color: var(--aws-red);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .caution-list {
      list-style: none;
      padding: 0;
    }

    .caution-list li {
      padding: 5px 0;
      font-size: 14px;
      display: flex;
      align-items: flex-start;
      gap: 8px;
      color: var(--aws-light-gray);
    }

    .caution-list li::before {
      content: "\26A0";
      flex-shrink: 0;
    }

    /* ===== Code Block ===== */
    .code-block {
      background: #1a1a2e;
      border-radius: 8px;
      overflow: hidden;
      margin: 16px 0;
    }

    .code-header {
      background: #16213e;
      padding: 8px 16px;
      display: flex;
      justify-content: space-between;
      font-size: 12px;
    }

    .code-lang {
      color: var(--aws-orange);
      font-weight: bold;
    }

    .code-title {
      color: var(--aws-light-gray);
    }

    .code-block pre {
      margin: 0;
      padding: 0;
      overflow-x: auto;
    }

    .code-block code {
      font-family: 'Courier New', monospace;
      font-size: 13px;
      line-height: 1.5;
      padding: 16px !important;
    }

    /* ===== Flow Diagram ===== */
    .flow-diagram {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
      margin: 24px 0;
    }

    .flow-step {
      background: var(--aws-dark-squid);
      border: 2px solid var(--aws-orange);
      border-radius: 8px;
      padding: 12px 20px;
      text-align: center;
      min-width: 120px;
      color: var(--aws-white);
      font-size: 14px;
    }

    .flow-arrow {
      color: var(--aws-orange);
      font-size: 24px;
      font-weight: bold;
    }

    /* ===== Region Badge ===== */
    .region-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(0, 161, 201, 0.1);
      border: 1px solid rgba(0, 161, 201, 0.3);
      border-radius: 8px;
      padding: 12px 20px;
      font-size: 15px;
      color: var(--aws-teal);
      font-weight: 500;
    }

    /* ===== Related Services ===== */
    .related-service {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 12px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.06);
    }

    .related-service:last-child { border-bottom: none; }

    .related-service-icon {
      font-size: 24px;
      flex-shrink: 0;
    }

    .related-service-name {
      font-weight: 600;
      color: var(--aws-white);
      font-size: 15px;
    }

    .related-service-desc {
      font-size: 13px;
      color: var(--aws-light-gray);
    }

    /* ===== Mermaid ===== */
    .mermaid-container {
      background: #FFFFFF;
      border-radius: 12px;
      padding: 24px;
      margin: 20px 0;
      border: 2px solid rgba(255, 153, 0, 0.3);
      overflow-x: auto;
    }

    .mermaid {
      display: flex;
      justify-content: center;
    }

    /* ===== Summary Box ===== */
    .summary-box {
      background: linear-gradient(135deg, rgba(255, 153, 0, 0.12), rgba(140, 79, 255, 0.08));
      border: 2px solid rgba(255, 153, 0, 0.3);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
    }

    .summary-box p {
      font-size: 15px;
      line-height: 1.8;
      color: var(--aws-light-gray);
    }

    /* ===== Footer ===== */
    footer {
      margin-top: 24px;
      padding-top: 16px;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
      font-size: 12px;
      color: var(--aws-light-gray);
    }

    footer a {
      color: var(--aws-teal);
      text-decoration: none;
      word-break: break-all;
    }

    footer a:hover { color: var(--aws-smile-orange); }

    .footer-links {
      list-style: none;
      padding: 0;
    }

    .footer-links li {
      padding: 3px 0;
    }

    /* ===== Responsive ===== */
    @media (max-width: 640px) {
      h1 { font-size: 26px; }
      .header { flex-direction: column; }
      .header-right { text-align: left; }
      .stats-grid { grid-template-columns: 1fr 1fr; }
    }
  </style>
</head>
<body>
  <div class="container">

    <!-- ===== Header ===== -->
    <div class="header">
      <div class="header-left">
        <div class="service-badge">Amazon EKS</div>
        <h1>&#128270; Node Monitoring Agent のオープンソース化</h1>
        <div class="subtitle">ノードヘルス監視エージェントのソースコードを GitHub で公開し、透明性とカスタマイズ性を向上</div>
      </div>
      <div class="header-right">
        <div><span class="date-label">&#128197; リリース日:</span> 2026 年 2 月 24 日</div>
      </div>
    </div>

    <!-- ===== Stats ===== -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-number">5</div>
        <div class="stat-label">監視対象の NodeCondition</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">2</div>
        <div class="stat-label">自動修復アクション</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">&#128275;</div>
        <div class="stat-label">オープンソース化</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">$0</div>
        <div class="stat-label">追加料金なし</div>
      </div>
    </div>

    <!-- ===== 概要 ===== -->
    <div class="section">
      <h2>&#128203; 概要</h2>
      <p class="overview-text">
        Amazon EKS Node Monitoring Agent が<span class="highlight">オープンソース</span>として公開されました。ソースコードは <a href="https://github.com/aws/eks-node-monitoring-agent" target="_blank" rel="noopener noreferrer" style="color: var(--aws-teal); text-decoration: none;">GitHub</a> で公開されており、誰でもアクセス、カスタマイズ、開発への貢献が可能です。
      </p>
      <p class="overview-text">
        Node Monitoring Agent は、ノードレベルの<span class="highlight">システム</span>、<span class="highlight">ストレージ</span>、<span class="highlight">ネットワーキング</span>、<span class="highlight">アクセラレーター</span>の問題を自動的に監視し、Kubernetes の NodeCondition として公開します。これらの情報は Amazon EKS の自動ノード修復機能で活用され、障害ノードの迅速な検知と自動修復を実現します。
      </p>

      <!-- Before/After -->
      <div class="before-after">
        <div class="before-card">
          <div class="ba-label">&#10060; Before</div>
          <ul class="ba-list">
            <li>Node Monitoring Agent の内部実装がクローズドソースであり、エージェントの動作を詳細に理解できなかった</li>
            <li>特定の環境やワークロードに合わせたカスタマイズができなかった</li>
            <li>コミュニティからの直接的な機能改善やバグ修正への貢献ができなかった</li>
          </ul>
        </div>
        <div class="after-card">
          <div class="ba-label">&#9989; After</div>
          <ul class="ba-list">
            <li>ソースコードが GitHub で公開され、エージェントの実装を完全に把握可能に</li>
            <li>組織の要件に合わせたカスタマイズが可能に</li>
            <li>GitHub を通じてバグ報告、機能リクエスト、プルリクエストによる直接的な開発貢献が可能に</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- ===== アーキテクチャ図 ===== -->
    <div class="section">
      <h2>&#127959;&#65039; アーキテクチャ図</h2>
      <div class="mermaid-container">
        <pre class="mermaid">
flowchart TD
    subgraph EKSCluster["&#9729;&#65039; Amazon EKS クラスター"]
        subgraph ControlPlane["&#127899;&#65039; コントロールプレーン"]
            APIServer["&#128268; API サーバー"]
            AutoRepair["&#128295; 自動ノード修復"]
        end

        subgraph DataPlane["&#9881;&#65039; データプレーン"]
            subgraph Node1["&#128421;&#65039; ワーカーノード"]
                NMA1["&#128270; Node Monitoring&lt;br/&gt;Agent"]
                Pod1["&#128230; Pod A"]
                Pod2["&#128230; Pod B"]
            end

            subgraph Node2["&#128421;&#65039; ワーカーノード"]
                NMA2["&#128270; Node Monitoring&lt;br/&gt;Agent"]
                Pod3["&#128230; Pod C"]
            end
        end
    end

    subgraph Detection["&#128270; 問題検知カテゴリ"]
        direction LR
        System["&#128187; システム&lt;br/&gt;カーネル"]
        Storage["&#128190; ストレージ"]
        Network["&#127760; ネットワーク"]
        Accelerator["&#9889; アクセラレーター&lt;br/&gt;GPU / Neuron"]
        System ~~~ Storage ~~~ Network ~~~ Accelerator
    end

    subgraph Actions["&#128736;&#65039; 修復アクション"]
        direction LR
        Replace["&#128260; ノード置換"]
        Reboot["&#128257; ノード再起動"]
        Replace ~~~ Reboot
    end

    NMA1 -->|"ログ解析&lt;br/&gt;問題検知"| Detection
    NMA2 -->|"ログ解析&lt;br/&gt;問題検知"| Detection
    Detection -->|"NodeCondition&lt;br/&gt;として公開"| APIServer
    APIServer -->|"異常検知"| AutoRepair
    AutoRepair --> Actions

    classDef cloud fill:none,stroke:#CCCCCC,stroke-width:2px,color:#666666
    classDef layer fill:none,stroke:#E1BEE7,stroke-width:2px,color:#666666
    classDef control fill:#E8F1FF,stroke:#4A90E2,stroke-width:2px,color:#333333
    classDef node fill:#E3F2FD,stroke:#BBDEFB,stroke-width:2px,color:#1565C0
    classDef agent fill:#E9F7EC,stroke:#66BB6A,stroke-width:2px,color:#333333
    classDef pod fill:#FFE0B2,stroke:#FFCC80,stroke-width:2px,color:#5D4037
    classDef detect fill:#F3E5F5,stroke:#7B61FF,stroke-width:2px,color:#333333
    classDef action fill:#FFF3E0,stroke:#FF9800,stroke-width:2px,color:#333333

    class EKSCluster cloud
    class ControlPlane,DataPlane,Detection,Actions layer
    class APIServer,AutoRepair control
    class Node1,Node2 node
    class NMA1,NMA2 agent
    class Pod1,Pod2,Pod3 pod
    class System,Storage,Network,Accelerator detect
    class Replace,Reboot action
        </pre>
      </div>
      <p style="font-size: 13px; color: var(--aws-light-gray); margin-top: 8px;">
        EKS Node Monitoring Agent がワーカーノード上で DaemonSet として動作し、ノードログを解析して問題を検知する仕組みを示しています。検知された問題は NodeCondition として API サーバーに公開され、自動ノード修復機能がノードの置換または再起動を実行します。
      </p>
    </div>

    <!-- ===== 主要機能 ===== -->
    <div class="section">
      <h2>&#128640; 主要機能</h2>

      <div class="feature-card">
        <div class="feature-title">&#128270; ノードヘルス監視</div>
        <div class="feature-desc">
          <ul>
            <li>ワーカーノード上のログを解析し、ノードレベルの健全性問題を自動検知</li>
            <li>DaemonSet として全ワーカーノードにデプロイされ、継続的に監視を実施</li>
            <li>検知された問題は Kubernetes の NodeCondition および Event として公開</li>
          </ul>
        </div>
      </div>

      <div class="feature-card teal">
        <div class="feature-title">&#128203; 監視対象カテゴリ</div>
        <div class="feature-desc">
          <ul>
            <li><strong style="color: var(--aws-white);">AcceleratedHardwareReady:</strong> GPU (NVIDIA) や Neuron アクセラレーターのハードウェア障害を検知</li>
            <li><strong style="color: var(--aws-white);">ContainerRuntimeReady:</strong> コンテナランタイム (containerd) や kubelet の障害を検知</li>
            <li><strong style="color: var(--aws-white);">KernelReady:</strong> カーネルエラー、パニック、リソース枯渇を検知</li>
            <li><strong style="color: var(--aws-white);">NetworkingReady:</strong> ネットワークインターフェース、ルーティング、接続性の問題を検知</li>
            <li><strong style="color: var(--aws-white);">StorageReady:</strong> ディスク、ファイルシステム、I/O の問題を検知</li>
          </ul>
        </div>
      </div>

      <div class="feature-card purple">
        <div class="feature-title">&#128295; 自動ノード修復との連携</div>
        <div class="feature-desc">
          <ul>
            <li>Node Monitoring Agent が検知した NodeCondition に基づいて EKS がノードを自動修復</li>
            <li>修復アクションには「ノード置換」と「ノード再起動」がある</li>
            <li>Pod Disruption Budget を尊重し、最大 15 分間のドレイン試行後に強制修復を実行</li>
          </ul>
        </div>
      </div>

      <div class="feature-card green">
        <div class="feature-title">&#128275; オープンソース化のメリット</div>
        <div class="feature-desc">
          <ul>
            <li>ソースコードの完全な透明性により、エージェントの動作を詳細に把握可能</li>
            <li>組織のセキュリティポリシーやコンプライアンス要件に基づくコード監査が可能</li>
            <li>カスタマイズや独自の監視ルールの追加が可能</li>
            <li>GitHub を通じたコミュニティ貢献 (バグ報告、機能リクエスト、プルリクエスト) が可能</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- ===== 技術仕様 ===== -->
    <div class="section">
      <h2>&#128202; 技術仕様</h2>

      <p style="font-size: 15px; font-weight: 600; color: var(--aws-white); margin-bottom: 12px;">検知される NodeCondition 一覧</p>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>NodeCondition</th>
              <th>説明</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code style="color: var(--aws-orange);">AcceleratedHardwareReady</code></td>
              <td>GPU や Neuron などのアクセラレーターハードウェアが正常に動作しているか</td>
            </tr>
            <tr>
              <td><code style="color: var(--aws-orange);">ContainerRuntimeReady</code></td>
              <td>コンテナランタイムが正常に動作し、コンテナを実行可能か</td>
            </tr>
            <tr>
              <td><code style="color: var(--aws-orange);">KernelReady</code></td>
              <td>カーネルが重大なエラーやパニックなしに正常に動作しているか</td>
            </tr>
            <tr>
              <td><code style="color: var(--aws-orange);">NetworkingReady</code></td>
              <td>ネットワークスタックが正常に動作しているか</td>
            </tr>
            <tr>
              <td><code style="color: var(--aws-orange);">StorageReady</code></td>
              <td>ストレージサブシステムが正常に動作しているか</td>
            </tr>
          </tbody>
        </table>
      </div>

      <p style="font-size: 15px; font-weight: 600; color: var(--aws-white); margin-top: 24px; margin-bottom: 12px;">修復アクションとトリガー</p>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>修復対象の NodeCondition</th>
              <th>修復アクション</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code style="color: var(--aws-orange);">AcceleratedHardwareReady</code></td>
              <td>ノード置換またはノード再起動</td>
            </tr>
            <tr>
              <td><code style="color: var(--aws-orange);">ContainerRuntimeReady</code></td>
              <td>ノード置換</td>
            </tr>
            <tr>
              <td><code style="color: var(--aws-orange);">KernelReady</code></td>
              <td>ノード置換</td>
            </tr>
            <tr>
              <td><code style="color: var(--aws-orange);">NetworkingReady</code></td>
              <td>ノード置換</td>
            </tr>
            <tr>
              <td><code style="color: var(--aws-orange);">StorageReady</code></td>
              <td>ノード置換</td>
            </tr>
          </tbody>
        </table>
      </div>

      <p style="font-size: 15px; font-weight: 600; color: var(--aws-white); margin-top: 24px; margin-bottom: 12px;">デプロイメント構成</p>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>項目</th>
              <th>詳細</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong style="color: var(--aws-white);">デプロイ方式</strong></td>
              <td>DaemonSet</td>
            </tr>
            <tr>
              <td><strong style="color: var(--aws-white);">対応 OS</strong></td>
              <td>Linux のみ (Windows は非対応)</td>
            </tr>
            <tr>
              <td><strong style="color: var(--aws-white);">EKS Auto Mode</strong></td>
              <td>Node Monitoring Agent と自動ノード修復が自動的に有効</td>
            </tr>
            <tr>
              <td><strong style="color: var(--aws-white);">EKS アドオン</strong></td>
              <td><code style="color: var(--aws-orange);">eks-node-monitoring-agent</code> として追加可能</td>
            </tr>
            <tr>
              <td><strong style="color: var(--aws-white);">Helm</strong></td>
              <td>Helm チャートによるインストールが可能</td>
            </tr>
            <tr>
              <td><strong style="color: var(--aws-white);">対応コンピュートタイプ</strong></td>
              <td>EKS Auto Mode、マネージドノードグループ、Karpenter (Fargate は非対応)</td>
            </tr>
            <tr>
              <td><strong style="color: var(--aws-white);">GitHub リポジトリ</strong></td>
              <td><a href="https://github.com/aws/eks-node-monitoring-agent" target="_blank" rel="noopener noreferrer" style="color: var(--aws-teal); text-decoration: none;">aws/eks-node-monitoring-agent</a></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ===== 設定方法 ===== -->
    <div class="section">
      <h2>&#9881;&#65039; 設定方法</h2>

      <p style="font-size: 14px; color: var(--aws-light-gray); margin-bottom: 8px;"><strong style="color: var(--aws-white);">前提条件:</strong></p>
      <ul style="list-style: none; padding: 0; margin-bottom: 20px;">
        <li style="padding: 4px 0; font-size: 14px;">&#10003; Amazon EKS クラスターが稼働中であること</li>
        <li style="padding: 4px 0; font-size: 14px;">&#10003; <code style="color: var(--aws-orange);">kubectl</code> が設定済みでクラスターに接続可能であること</li>
        <li style="padding: 4px 0; font-size: 14px;">&#10003; AWS CLI がインストールされていること</li>
      </ul>

      <p style="font-size: 14px; color: var(--aws-orange); font-weight: 600; margin-bottom: 8px;">ステップ 1: EKS アドオンとしてデプロイ</p>
      <div class="code-block">
        <div class="code-header">
          <span class="code-lang">Bash</span>
          <span class="code-title">Node Monitoring Agent をインストール</span>
        </div>
        <pre><code class="language-bash"># EKS アドオンとして Node Monitoring Agent をインストール
aws eks create-addon \
  --cluster-name my-cluster \
  --addon-name eks-node-monitoring-agent \
  --region us-west-2</code></pre>
      </div>

      <p style="font-size: 14px; color: var(--aws-orange); font-weight: 600; margin-bottom: 8px; margin-top: 20px;">ステップ 2: アドオンのバージョンとスキーマを確認</p>
      <div class="code-block">
        <div class="code-header">
          <span class="code-lang">Bash</span>
          <span class="code-title">利用可能なバージョンとスキーマの確認</span>
        </div>
        <pre><code class="language-bash"># 利用可能なアドオンバージョンを確認
aws eks describe-addon-versions \
  --addon-name eks-node-monitoring-agent \
  --kubernetes-version 1.35 \
  --query='addons[].addonVersions[].addonVersion'

# アドオンのスキーマを確認
aws eks describe-addon-configuration \
  --addon-name eks-node-monitoring-agent \
  --addon-version v1.5.1-eksbuild.1</code></pre>
      </div>

      <p style="font-size: 14px; color: var(--aws-orange); font-weight: 600; margin-bottom: 8px; margin-top: 20px;">ステップ 3: カスタム設定でのデプロイ</p>
      <div class="code-block">
        <div class="code-header">
          <span class="code-lang">Bash</span>
          <span class="code-title">リソースリクエスト/リミットをカスタマイズ</span>
        </div>
        <pre><code class="language-bash"># カスタム設定を JSON で指定してインストール
aws eks create-addon \
  --cluster-name my-cluster \
  --addon-name eks-node-monitoring-agent \
  --configuration-values '{
    "monitoringAgent": {
      "resources": {
        "requests": {
          "cpu": "50m",
          "memory": "64Mi"
        },
        "limits": {
          "cpu": "200m",
          "memory": "256Mi"
        }
      }
    }
  }' \
  --region us-west-2</code></pre>
      </div>

      <p style="font-size: 14px; color: var(--aws-orange); font-weight: 600; margin-bottom: 8px; margin-top: 20px;">ステップ 4: ノードの健全性を確認</p>
      <div class="code-block">
        <div class="code-header">
          <span class="code-lang">Bash</span>
          <span class="code-title">ノードの状態と Agent の稼働確認</span>
        </div>
        <pre><code class="language-bash"># 全ノードの NodeCondition を確認
kubectl get nodes -o 'custom-columns=NAME:.metadata.name,CONDITIONS:.status.conditions[*].type,STATUS:.status.conditions[*].status'

# Node Monitoring Agent が報告したイベントを確認
kubectl get events --field-selector=reportingComponent=eks-node-monitoring-agent

# Pod が正常に稼働しているか確認
kubectl get pods -n kube-system -l app.kubernetes.io/name=eks-node-monitoring-agent</code></pre>
      </div>

      <p style="font-size: 14px; color: var(--aws-orange); font-weight: 600; margin-bottom: 8px; margin-top: 20px;">自動ノード修復の有効化</p>
      <div class="code-block">
        <div class="code-header">
          <span class="code-lang">Bash</span>
          <span class="code-title">マネージドノードグループでの自動修復設定</span>
        </div>
        <pre><code class="language-bash"># 新しいマネージドノードグループを自動ノード修復有効で作成
aws eks create-nodegroup \
  --cluster-name my-cluster \
  --nodegroup-name my-nodegroup \
  --node-role arn:aws:iam::123456789012:role/eks-node-role \
  --subnets subnet-12345 subnet-67890 \
  --node-repair-config enabled=true \
  --region us-west-2

# 既存のマネージドノードグループで自動ノード修復を有効化
aws eks update-nodegroup-config \
  --cluster-name my-cluster \
  --nodegroup-name my-nodegroup \
  --node-repair-config enabled=true \
  --region us-west-2</code></pre>
      </div>

      <div class="flow-diagram" style="margin-top: 24px;">
        <div class="flow-step">&#128230; アドオン<br/>インストール</div>
        <span class="flow-arrow">&rarr;</span>
        <div class="flow-step">&#128270; DaemonSet<br/>デプロイ</div>
        <span class="flow-arrow">&rarr;</span>
        <div class="flow-step">&#128295; 自動修復<br/>有効化</div>
        <span class="flow-arrow">&rarr;</span>
        <div class="flow-step">&#9989; 自動監視<br/>開始</div>
      </div>
    </div>

    <!-- ===== メリット ===== -->
    <div class="section">
      <h2>&#9989; メリット</h2>
      <div class="merit-grid">
        <div class="merit-box business">
          <h3>&#128188; ビジネス面</h3>
          <ul class="merit-list">
            <li>&rarr; <strong>運用コスト削減:</strong> ノードの健全性問題を自動検知・修復し、手動での監視・対応作業を削減</li>
            <li>&rarr; <strong>可用性向上:</strong> 障害ノードの迅速な検知と自動修復により、ワークロードのダウンタイムを最小化</li>
            <li>&rarr; <strong>透明性の向上:</strong> オープンソース化により、エージェントの動作を完全に把握でき、セキュリティ監査やコンプライアンス対応が容易に</li>
          </ul>
        </div>
        <div class="merit-box technical">
          <h3>&#128295; 技術面</h3>
          <ul class="merit-list">
            <li>&rarr; <strong>カスタマイズ可能:</strong> 組織固有の監視要件に合わせてエージェントを拡張・カスタマイズ可能</li>
            <li>&rarr; <strong>GPU 監視:</strong> NVIDIA DCGM との統合により、GPU ハードウェアの詳細な障害検知を実現</li>
            <li>&rarr; <strong>コミュニティ駆動の改善:</strong> オープンソースコミュニティの貢献により、継続的な機能改善とバグ修正が期待できる</li>
            <li>&rarr; <strong>Helm チャート対応:</strong> Helm チャートによる柔軟なデプロイメントとカスタム設定が可能</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- ===== デメリット・制約事項 ===== -->
    <div class="section">
      <h2>&#9888;&#65039; デメリット・制約事項</h2>
      <div class="caution-card">
        <h3>&#128679; 制限事項</h3>
        <ul class="caution-list">
          <li>Linux のみ対応であり、Windows ノードでは利用不可</li>
          <li>AWS Fargate では利用不可</li>
          <li>自動ノード修復は DiskPressure、MemoryPressure、PIDPressure の標準 Kubernetes NodeCondition には反応しない</li>
          <li>既存の NVIDIA DCGM インストールとの共存は現時点でサポートされていない</li>
        </ul>
      </div>
      <div class="caution-card">
        <h3>&#128161; 考慮すべき点</h3>
        <ul class="caution-list">
          <li>Node Monitoring Agent と自動ノード修復を最大限に活用するには、両方を組み合わせて使用することを推奨</li>
          <li>自動ノード修復は Pod Disruption Budget を尊重するが、最大 15 分間のドレイン試行後に強制修復を実行するため、適切な PDB 設定が重要</li>
          <li>オープンソース版をカスタマイズして使用する場合、アップストリームの更新との同期を自己管理する必要がある</li>
        </ul>
      </div>
    </div>

    <!-- ===== ユースケース ===== -->
    <div class="section">
      <h2>&#128161; ユースケース</h2>

      <div class="usecase-card">
        <div class="usecase-title">&#9889; ユースケース 1: GPU ワークロードの安定運用</div>
        <div class="usecase-scenario"><strong style="color: var(--aws-white);">シナリオ:</strong> 機械学習のトレーニングジョブを NVIDIA GPU インスタンス上で実行しており、GPU ハードウェア障害によるジョブ失敗を最小化したい。</div>
        <div class="usecase-effect">&rarr; NVIDIA XID エラーや DCGM ヘルスチェックの失敗を自動検知し、障害のある GPU ノードを自動的に置換またはリブートすることで、トレーニングジョブの中断を最小化。</div>
      </div>

      <div class="usecase-card">
        <div class="usecase-title">&#128421;&#65039; ユースケース 2: 大規模クラスターの運用効率化</div>
        <div class="usecase-scenario"><strong style="color: var(--aws-white);">シナリオ:</strong> 数百台のワーカーノードを運用する大規模 EKS クラスターで、ノード障害の手動検知と対応に多大な運用工数が発生している。</div>
        <div class="usecase-effect">&rarr; ノードレベルの問題を自動検知・修復し、クラスター管理者の運用負荷を大幅に削減。手動でのノード監視・SSH 接続によるログ確認作業が不要に。</div>
      </div>

      <div class="usecase-card">
        <div class="usecase-title">&#128274; ユースケース 3: エージェントのカスタマイズと拡張</div>
        <div class="usecase-scenario"><strong style="color: var(--aws-white);">シナリオ:</strong> 組織固有のセキュリティ要件やコンプライアンスポリシーに基づき、Node Monitoring Agent の動作を検証し、必要に応じてカスタム監視ルールを追加したい。</div>
        <div class="usecase-effect">&rarr; オープンソースのコードを監査してセキュリティ要件を満たしていることを確認。組織固有の監視要件に合わせたカスタマイズが可能になり、標準のエージェントでは対応できないユースケースにも対応可能。</div>
      </div>
    </div>

    <!-- ===== 料金情報 ===== -->
    <div class="section">
      <h2>&#128179; 料金</h2>
      <p style="font-size: 14px; color: var(--aws-light-gray); margin-bottom: 16px;">EKS Node Monitoring Agent の使用に<span class="highlight">追加料金はかかりません</span>。標準の Amazon EKS 料金が適用されます。</p>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>項目</th>
              <th>料金</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong style="color: var(--aws-white);">EKS コントロールプレーン</strong></td>
              <td>クラスターあたり $0.10/時間</td>
            </tr>
            <tr>
              <td><strong style="color: var(--aws-white);">ワーカーノード</strong></td>
              <td>EC2 インスタンス料金が適用</td>
            </tr>
            <tr>
              <td><strong style="color: var(--aws-white);">EKS Auto Mode</strong></td>
              <td>Auto Mode 固有の料金体系が適用</td>
            </tr>
            <tr>
              <td><strong style="color: var(--aws-white);">Node Monitoring Agent</strong></td>
              <td style="color: var(--aws-green); font-weight: 600;">追加料金なし</td>
            </tr>
          </tbody>
        </table>
      </div>
      <p style="font-size: 13px; color: var(--aws-light-gray); margin-top: 12px;">
        詳細な料金情報については、<a href="https://aws.amazon.com/eks/pricing/" target="_blank" rel="noopener noreferrer" style="color: var(--aws-teal); text-decoration: none;">Amazon EKS 料金ページ</a>を参照してください。
      </p>
    </div>

    <!-- ===== 利用可能リージョン ===== -->
    <div class="section">
      <h2>&#127758; 利用可能リージョン</h2>
      <div class="region-badge">
        &#127760; EKS が利用可能なすべての AWS リージョンで EKS アドオンとして利用可能
      </div>
      <p style="font-size: 13px; color: var(--aws-light-gray); margin-top: 12px;">
        EKS Auto Mode を使用している場合は自動的に含まれます。
      </p>
    </div>

    <!-- ===== 関連サービス ===== -->
    <div class="section">
      <h2>&#128279; 関連サービス・機能</h2>
      <div class="related-service">
        <div class="related-service-icon">&#9881;&#65039;</div>
        <div>
          <div class="related-service-name">Amazon EKS Auto Mode</div>
          <div class="related-service-desc">Node Monitoring Agent と自動ノード修復が自動的に含まれるフルマネージドコンピュートオプション</div>
        </div>
      </div>
      <div class="related-service">
        <div class="related-service-icon">&#128295;</div>
        <div>
          <div class="related-service-name">EKS 自動ノード修復</div>
          <div class="related-service-desc">Node Monitoring Agent が検知した問題に基づいてノードを自動修復する機能</div>
        </div>
      </div>
      <div class="related-service">
        <div class="related-service-icon">&#128640;</div>
        <div>
          <div class="related-service-name">Karpenter</div>
          <div class="related-service-desc">オープンソースの Kubernetes ノードオートスケーラー。v1.10 以降で自動ノード修復との連携が可能</div>
        </div>
      </div>
      <div class="related-service">
        <div class="related-service-icon">&#128421;&#65039;</div>
        <div>
          <div class="related-service-name">Amazon EKS マネージドノードグループ</div>
          <div class="related-service-desc">ノードグループレベルで自動ノード修復を有効化可能</div>
        </div>
      </div>
      <div class="related-service">
        <div class="related-service-icon">&#9889;</div>
        <div>
          <div class="related-service-name">NVIDIA DCGM</div>
          <div class="related-service-desc">Node Monitoring Agent に含まれる GPU 監視コンポーネント</div>
        </div>
      </div>
    </div>

    <!-- ===== まとめ ===== -->
    <div class="summary-box">
      <h2>&#128221; まとめ</h2>
      <p>
        Amazon EKS Node Monitoring Agent のオープンソース化により、エージェントのソースコードが GitHub で公開され、実装の透明性が大幅に向上しました。Node Monitoring Agent は、ノードレベルのシステム、ストレージ、ネットワーキング、アクセラレーターの問題を自動的に検知し、Kubernetes の NodeCondition として公開することで、EKS の自動ノード修復機能と連携してクラスターの信頼性を向上させます。EKS Auto Mode では自動的に含まれ、その他のコンピュートタイプでは EKS アドオンとして簡単にデプロイ可能です。オープンソースコミュニティへの参加を通じて、エージェントの改善に直接貢献できるようになったことは、EKS ユーザーにとって大きなメリットとなります。
      </p>
    </div>

    <!-- ===== Footer ===== -->
    <footer>
      <p style="margin-bottom: 8px;"><strong style="color: var(--aws-orange);">&#128206; 参考リンク</strong></p>
      <ul class="footer-links">
        <li>&#128196; <a href="https://aws.amazon.com/about-aws/whats-new/2026/02/amazon-eks-node-monitoring-agent-open-source/" target="_blank" rel="noopener noreferrer">公式発表 (What's New)</a></li>
        <li>&#128187; <a href="https://github.com/aws/eks-node-monitoring-agent" target="_blank" rel="noopener noreferrer">GitHub リポジトリ</a></li>
        <li>&#128214; <a href="https://docs.aws.amazon.com/eks/latest/userguide/node-health.html" target="_blank" rel="noopener noreferrer">ドキュメント - ノードヘルスの検知と自動修復</a></li>
        <li>&#128214; <a href="https://docs.aws.amazon.com/eks/latest/userguide/node-health-nma.html" target="_blank" rel="noopener noreferrer">ドキュメント - Node Monitoring Agent の詳細</a></li>
        <li>&#128221; <a href="https://aws.amazon.com/blogs/containers/amazon-eks-introduces-node-monitoring-and-auto-repair-capabilities/" target="_blank" rel="noopener noreferrer">ブログ - Amazon EKS introduces node monitoring and auto repair capabilities</a></li>
        <li>&#128176; <a href="https://aws.amazon.com/eks/pricing/" target="_blank" rel="noopener noreferrer">Amazon EKS 料金ページ</a></li>
      </ul>
      <p style="margin-top: 12px; font-size: 11px; color: rgba(213, 219, 219, 0.5);">Generated from reports/2026/2026-02-24-amazon-eks-node-monitoring-agent-open-source.md</p>
    </footer>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        primaryColor: '#FF9900',
        primaryTextColor: '#232F3E',
        primaryBorderColor: '#FF9900',
        lineColor: '#FF9900',
        secondaryColor: '#F5F5F5',
        tertiaryColor: '#FAFAFA',
        background: '#FFFFFF',
        mainBkg: '#FFF3E0',
        nodeBorder: '#FF9900',
        clusterBkg: '#FFF8E1',
        clusterBorder: '#FF9900',
        edgeLabelBackground: '#FFFFFF',
        textColor: '#232F3E'
      }
    });
  </script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
</body>
</html>